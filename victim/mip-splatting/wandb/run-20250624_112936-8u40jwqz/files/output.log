Output folder: /workspace/wwang/poison-splat/log/chair_trigger/checkerboard_bw [24/06 11:29:37]
Using poisoned dataset loader [24/06 11:29:37]
Found transforms_train.json file, assuming Blender data set! [24/06 11:29:37]
Reading Training Transforms [24/06 11:29:37]
Reading Test Transforms [24/06 11:29:42]
Loading Training Cameras [24/06 11:29:50]
Loading Test Cameras [24/06 11:29:58]
Number of points at initialisation :  100000 [24/06 11:30:08]

================================================== [24/06 11:30:09]
POISON STATISTICS [24/06 11:30:09]
================================================== [24/06 11:30:09]
Total training samples: 100 [24/06 11:30:09]
Poisoned samples: 5 [24/06 11:30:09]
Poison ratio: 5.00% [24/06 11:30:09]
Trigger type: synthetic [24/06 11:30:09]
Trigger position: bottom_right [24/06 11:30:09]
================================================== [24/06 11:30:09]
 [24/06 11:30:09]
Computing 3D filter [24/06 11:30:09]
Training progress:   0%|                                                                                                                                                                                                               | 0/5000 [00:00<?, ?it/s]/workspace/wwang/poison-splat/victim/mip-splatting/../../attacker/utils/losses.py:28: UserWarning: Using a target size (torch.Size([3])) that is different to the input size (torch.Size([16, 3])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
Total gaussians: 100000 [24/06 11:30:12]
Gaussians in target region: 5805 [24/06 11:30:12]
Target region: [[-0.5 -0.5 -0.5], [0.5 0.5 0.5]] [24/06 11:30:12]
[SCARF DEBUG] 当前iteration: 5, 选中基元数量: 5805 [24/06 11:30:12]
[SCARF DEBUG] target_features.shape: torch.Size([5805, 16, 3]), mu.shape: torch.Size([3]) [24/06 11:30:12]
[SCARF DEBUG] target_features.requires_grad: True [24/06 11:30:12]
  mean_loss = F.mse_loss(mean_features, mu)
/workspace/wwang/poison-splat/victim/mip-splatting/../../attacker/utils/losses.py:60: UserWarning: Using a target size (torch.Size([3])) that is different to the input size (torch.Size([16, 3])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  mean_distance = F.mse_loss(mean_features, mu).item()
Total gaussians: 100000 [24/06 11:30:13]
Gaussians in target region: 5831 [24/06 11:30:13]
Target region: [[-0.5 -0.5 -0.5], [0.5 0.5 0.5]] [24/06 11:30:13]
[SCARF DEBUG] 当前iteration: 10, 选中基元数量: 5831 [24/06 11:30:13]
[SCARF DEBUG] target_features.shape: torch.Size([5831, 16, 3]), mu.shape: torch.Size([3]) [24/06 11:30:13]
[SCARF DEBUG] target_features.requires_grad: True [24/06 11:30:13]
Training progress:   2%|██▉                                                                                                                                                  | 100/5000 [00:08<04:15, 19.20it/s, Render_Loss=0.0681165, Collapse_Loss=0.0000000]Traceback (most recent call last):
Total gaussians: 100000 [24/06 11:30:16]
Gaussians in target region: 6146 [24/06 11:30:16]
Target region: [[-0.5 -0.5 -0.5], [0.5 0.5 0.5]] [24/06 11:30:16]
[SCARF DEBUG] 当前iteration: 44, 选中基元数量: 6146 [24/06 11:30:16]
[SCARF DEBUG] target_features.shape: torch.Size([6146, 16, 3]), mu.shape: torch.Size([3]) [24/06 11:30:16]
[SCARF DEBUG] target_features.requires_grad: True [24/06 11:30:16]
Total gaussians: 100000 [24/06 11:30:17]
Gaussians in target region: 6400 [24/06 11:30:17]
Target region: [[-0.5 -0.5 -0.5], [0.5 0.5 0.5]] [24/06 11:30:17]
[SCARF DEBUG] 当前iteration: 66, 选中基元数量: 6400 [24/06 11:30:17]
[SCARF DEBUG] target_features.shape: torch.Size([6400, 16, 3]), mu.shape: torch.Size([3]) [24/06 11:30:17]
[SCARF DEBUG] target_features.requires_grad: True [24/06 11:30:17]
Total gaussians: 100000 [24/06 11:30:18]
Gaussians in target region: 6442 [24/06 11:30:18]
Target region: [[-0.5 -0.5 -0.5], [0.5 0.5 0.5]] [24/06 11:30:18]
[SCARF DEBUG] 当前iteration: 72, 选中基元数量: 6442 [24/06 11:30:18]
[SCARF DEBUG] target_features.shape: torch.Size([6442, 16, 3]), mu.shape: torch.Size([3]) [24/06 11:30:18]
[SCARF DEBUG] target_features.requires_grad: True [24/06 11:30:18]
  File "/workspace/wwang/poison-splat/victim/mip-splatting/train_scarf.py", line 436, in <module>
    training(lp.extract(args), op.extract(args), pp.extract(args), args.test_iterations, args.save_iterations, args.checkpoint_iterations, args.start_checkpoint, args.debug_from, poison_config, wandb_run)
  File "/workspace/wwang/poison-splat/victim/mip-splatting/train_scarf.py", line 207, in training
    ema_loss_for_log = 0.4 * loss_render.item() + 0.6 * ema_loss_for_log
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f142a3e3d00>
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/service_connection.py", line 90, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/lib/service_connection.py", line 218, in teardown
    self._router.join()
  File "/usr/local/lib/python3.10/dist-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt:
